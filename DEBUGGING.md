# BlackBox AI 디버깅 가이드

이 문서는 BlackBox AI 애플리케이션의 디버깅 방법을 설명합니다.

## 디버깅 환경 설정

### 1. VS Code 디버깅 설정

프로젝트에는 VS Code 디버깅 설정이 포함되어 있습니다. `.vscode/launch.json` 파일에 다음과 같은 구성이 있습니다:

- **Debug Main Process**: Electron 메인 프로세스 디버깅
- **Debug Renderer Process**: Electron 렌더러 프로세스 디버깅
- **Debug All**: 메인 프로세스와 렌더러 프로세스를 동시에 디버깅

### 2. 디버깅 스크립트

`debug.js` 스크립트를 사용하여 디버깅 모드로 애플리케이션을 실행할 수 있습니다:

```bash
node debug.js
```

이 스크립트는 다음과 같은 기능을 제공합니다:

- 메인 프로세스와 렌더러 프로세스의 로그를 `logs` 디렉토리에 저장
- 오디오 및 CSS 관련 로그를 색상으로 강조 표시
- 디버깅에 필요한 Electron 플래그 설정
- 개발 모드에서 원본 소스 위치에서 직접 파일을 로드

## 개발 모드 특징

개발 모드에서는 다음과 같은 특징이 있습니다:

1. **원본 소스 사용**: 빌드된 파일이 아닌 원본 소스 파일을 직접 로드합니다.
2. **CSS 자동 로드**: 개발 모드에서 CSS 파일이 자동으로 로드됩니다.
3. **개발 모드 표시**: 화면 우측 하단에 "DEV MODE" 표시가 나타납니다.
4. **자동 새로고침**: 소스 파일 변경 시 자동으로 새로고침되지는 않지만, F5 키를 눌러 수동으로 새로고침할 수 있습니다.

## 디버깅 방법

### VS Code에서 디버깅

1. VS Code에서 디버깅 패널 열기 (Ctrl+Shift+D 또는 Cmd+Shift+D)
2. 드롭다운 메뉴에서 "Debug All" 선택
3. 시작 버튼(녹색 삼각형) 클릭
4. 중단점을 설정하여 코드 실행 추적

### 브라우저 개발자 도구로 렌더러 프로세스 디버깅

1. `node debug.js` 명령으로 애플리케이션 실행
2. Chrome 브라우저를 열고 `chrome://inspect` 주소로 이동
3. "Configure..." 버튼을 클릭하고 "localhost:9222" 추가
4. "Remote Target" 아래에 나타나는 BlackBox AI 애플리케이션의 "inspect" 링크 클릭
5. 개발자 도구에서 콘솔 탭과 소스 탭을 사용하여 디버깅

### 애플리케이션 내 개발자 도구

1. 애플리케이션 실행 (디버깅 모드로)
2. 애플리케이션 창에서 F12 또는 Ctrl+Shift+I (Cmd+Option+I) 키를 눌러 개발자 도구 열기
3. 콘솔 탭에서 로그 확인
4. 소스 탭에서 중단점 설정 및 코드 디버깅

### 오디오 레코딩 디버깅

오디오 레코딩 문제를 디버깅하기 위해 다음 사항을 확인하세요:

1. **권한 확인**: 마이크 접근 권한이 허용되어 있는지 확인
2. **오디오 디렉토리 확인**: 로그에서 오디오 파일이 저장되는 디렉토리 확인
3. **브라우저 콘솔 로그**: 렌더러 프로세스의 콘솔 로그에서 오디오 관련 오류 확인
4. **메인 프로세스 로그**: `logs/main-process.log` 파일에서 오디오 관련 오류 확인

## 주요 디버깅 포인트

### 오디오 레코딩 문제

오디오 레코딩 문제를 디버깅할 때 다음 부분을 중점적으로 확인하세요:

1. **MediaRecorder 생성**: `src/renderer/audio-recorder.js`의 `startRecordingInternal` 함수
2. **오디오 데이터 저장**: `src/modules/audio-recorder/audio-recorder.ts`의 `audio-recorder:save-blob` 핸들러
3. **파일 시스템 접근**: 오디오 파일 저장 경로와 권한
4. **IPC 통신**: 렌더러 프로세스와 메인 프로세스 간의 메시지 전달

### CSS 문제

개발 모드에서 CSS 문제를 디버깅할 때 다음 부분을 확인하세요:

1. **CSS 파일 로드**: 개발자 도구의 네트워크 탭에서 CSS 파일이 제대로 로드되는지 확인
2. **CSS 경로**: `src/renderer/index.html`에서 CSS 파일 경로가 올바른지 확인
3. **개발 모드 스크립트**: `src/renderer/dev-mode.js` 스크립트가 제대로 실행되는지 확인

### 디버깅 로그 확인

디버깅 로그는 다음 위치에 저장됩니다:

- **메인 프로세스 로그**: `logs/main-process.log`
- **렌더러 프로세스 로그**: `logs/renderer-process.log`

또한 브라우저 개발자 도구의 콘솔에서도 렌더러 프로세스 로그를 확인할 수 있습니다.

## 문제 해결 팁

1. **오디오 API 지원 확인**: 브라우저 콘솔에서 `navigator.mediaDevices` 및 `MediaRecorder` 지원 여부 확인
2. **파일 시스템 권한 확인**: 오디오 파일 저장 디렉토리의 쓰기 권한 확인
3. **IPC 통신 확인**: 메인 프로세스와 렌더러 프로세스 간의 메시지 전달 확인
4. **오디오 스트림 확인**: 마이크 접근 및 오디오 스트림 생성 확인
5. **CSS 경로 확인**: 개발 모드에서 CSS 파일 경로가 올바른지 확인

## 개발 모드와 빌드 모드 전환

- **개발 모드**: `node debug.js` 명령으로 실행
- **빌드 모드**: `npm run build` 명령으로 빌드 후 `npm start` 명령으로 실행
